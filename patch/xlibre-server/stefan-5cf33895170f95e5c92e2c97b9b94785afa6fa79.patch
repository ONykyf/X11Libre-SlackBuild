From 5cf33895170f95e5c92e2c97b9b94785afa6fa79 Mon Sep 17 00:00:00 2001
From: stefan11111 <stefan11111@shitposting.expert>
Date: Fri, 1 Aug 2025 02:16:23 +0300
Subject: [PATCH] xfree86: loader: warn when implicitly ignoring abi mismatch
 for the nvidia proprietary DDX driver

Signed-off-by: stefan11111 <stefan11111@shitposting.expert>
---
 hw/xfree86/loader/loadmod.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/hw/xfree86/loader/loadmod.c b/hw/xfree86/loader/loadmod.c
index e010f100f8..1fd1f15dfc 100644
--- a/hw/xfree86/loader/loadmod.c
+++ b/hw/xfree86/loader/loadmod.c
@@ -682,6 +682,12 @@ LoadModule(const char *module, void *options, const XF86ModReqInfo *modreq,
         m = (char *) module;
     }
 
+    if (is_nvidia_proprietary && !LoaderIgnoreAbi) {
+        /* warn every time this is hit */
+        LogMessage(X_WARNING, "LoadModule: Implicitly ignoring abi mismatch "
+                   "for the nvidia proprierary DDX driver\n");
+    }
+
     /* Backward compatibility, vbe and int10 are merged into int10 now */
     if (!strcmp(m, "vbe"))
         m = name = strdup("int10");
